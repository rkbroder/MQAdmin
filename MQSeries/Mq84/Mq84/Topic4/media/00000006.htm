<!doctype html public "-//W3C//DTD HTML 4.0//EN">
<html>
<head><title>Topic 4 - Triggering - Audio transcript </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#FFCC66">

<font face="Arial,Helvetica">

<H1>MQ84 - Topic 4: Triggering</h1>

<FONT SIZE="+2">Triggering </FONT>
<br>
When a client application puts a message onto a queue it is requesting the service provided by that queue.
<P>
The application is not aware of what  service will be provided or when. Therefore, it may have to wait for the reply.
<P>
To allow for the automatic activation of the server application, MQSeries provides a facility known as triggering.
<P>
This topic describes how to define and manage the triggering facility.
<P>
Click Next to continue.
<br><br><br>

<FONT SIZE="+2">Triggering</FONT>
<br>
When an application puts a message on a queue, the queue manager interrogates the attributes of the queue.
<P>
If the queue’s triggering conditions are satisfied, a trigger control message is generated.
This new message is put on an associated initiation queue and describes the server application to be activated. After putting this message, control reverts to the calling application.
<P>
When the trigger control message becomes available, the associated trigger monitor program gets the message and activates the requested application.
<P>
Click each object for an explanation of the object, then click Next to complete this topic.
<br><br><br>


<FONT SIZE="+2">The user message</FONT>
<br>
The application message is placed onto the queue with no special actions being performed by the MQI call.
<P>
The message has no special properties, but may contain MQMD settings that will cause triggering to be evaluated. Rolling the mouse over the MQMD structure will highlight this. Further details on triggering conditions are available by viewing the local queue definition.
<br><br><br>


<FONT SIZE="+2">The application queue </FONT>
<br>
Only local and model queue definitions support the trigger attributes.
<P>
But as model queues dynamically generate local queues, only local queues can be triggered.
<P>
To enable triggering, the trigger control attribute must be set to on.
<P>
The process and INITQ parameters must be specified, while the remaining attributes are optional and can be left to default.
<P>
Click on each parameter for a description and further instructions.
<br><br><br>


<FONT SIZE="+2">The application server</FONT>
<br>
The application server is activated by the trigger monitor and proceeds to service the application queue by getting messages. The name of the queue to service is passed as part of a parameter string, set up by the trigger monitor.
<P>
Click Next to continue.
<br><br><br>


<FONT SIZE="+2">The triggering conditions</FONT>
<br>
All of these conditions must be met for the queue manager to put a trigger control message on the initiation queue.
<P>
Take a moment and examine each of the conditions and roll the mouse over the condition if further information is required.
<P>
When finished, click Next to see further details regarding the triggering event.
<br><br><br>


<FONT SIZE="+2">The application activation</FONT>
<br>
The trigger monitor submits to the operational environment a command stream to activate the application as described by the MQTM message retrieved from the initiation queue. The method of activation will vary according to the type of platform and the trigger monitor may not be able to detect the failure of the request.
<P>
Click on each item for a description, then click Next to continue.
<br><br><br>


<FONT SIZE="+2">The Trigger Monitor</FONT>
<br>
Trigger monitors are supplied with the MQSeries product for all implementations that support the triggering feature.
<P>
If there is a need to modify or create a new trigger monitor, the source of sample trigger monitors has been supplied.
<P>
Click Next for further information.
<br><br><br>


<FONT SIZE="+2">The trigger control message</FONT>
<br>
The trigger control message is a standard MQSeries message. It contains the required MQSeries header, the MQMD, and a message data area that maps to the format MQTM.
<P>
Click on the different parts of the message to see further information, then click Next to continue.
<br><br><br>


<FONT SIZE="+2">Use of the Dead Letter Queue</FONT>
<br>
The message that is written to the dead letter queue is a standard dead letter message. It has the failing message plus an additional header known as the dead letter header. This additional header describes why the message has been placed on the queue.
<br><br><br>


<FONT SIZE="+2">The Process definition </FONT>
<br>
A process object identifies an application that can be activated by the MQSeries triggering mechanism. A process definition is referred to by local queue definitions when the application described by the process is required to service the queue.
<P>
The application described by this definition may also be named in other process definitions.
<P>
Click on each parameter and the OS/400 image for an explanation. Further information can be found by clicking the Next button within the textbox windows.
<br><br><br>



<FONT SIZE="+2">The Process definition</FONT>
<br>
The value of the application type field indicates that the application being started can only be validly activated on an environment of the same type.
<br><br><br>


<FONT SIZE="+2">The Process definition</FONT>
<br>
If the applicid value contains non-valid MQSeries literal values it must be enclosed in single quotation marks within the brackets.  The application is only fully qualified when required by the environment.
<br><br><br>


<FONT SIZE="+2">The Process definition</FONT>
<br>
The USERDATA field of the process definition is used by the channel initiator supplied with the version 2 queue manager. The USERDATA field will contain the 20-character name of the channel to be activated.
<P>
The alternative for version 5 queue managers is to indicate the channel name in the TRIGDATA parameter of the transmission queue.
<br><br><br>


<FONT SIZE="+2">The Process definition</FONT>
<br>
On UNIX platforms, the environment data parameter is set to indicate that the application is to be started in the background. This use of the parameter is supported by the supplied trigger monitors.
<br><br><br>


<FONT SIZE="+2">The trigger type field </FONT>
<br>
The type of triggering chosen will depend on the nature of the application and the service agreements governing the overall business process. In all cases the application that is activated by the trigger mechanism should not be dependent on the trigger type value.
Roll the mouse over the trigger types to see further information. Then Click Next to continue.
<br><br><br>


</font>
</body>
</html>
